{% extends 'index.html' %}
{% block title %}Trang ch·ªß{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-6">

    <!-- Tabs ti√™u ƒë·ªÅ -->
    <div class="flex justify-between items-start mb-6 flex-wrap">

            <!-- Slider truy·ªán n·ªïi b·∫≠t -->
    <div class="flex-1">
        <ul class="flex space-x-4 text-sm font-semibold">
            <li><a href="#" class="bg-yellow-500 text-white px-3 py-1 rounded shadow">üèÜ N·ªïi b·∫≠t</a></li>
            <li><a href="#" class="text-gray-600 hover:text-black">Top th√°ng</a></li>
            <li><a href="#" class="text-gray-600 hover:text-black">To√†n t/gian</a></li>
        </ul>

        <!-- Slider s·ª≠ d·ª•ng c√πng d·ªØ li·ªáu novels -->
        <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4 mt-4">
            {% for novel in novels|slice:":6" %}
            <div class="bg-white rounded-md shadow hover:shadow-lg transition overflow-hidden group">
                <a href="{% url 'novels:novel_detail' novel.id %}">
                    <div class="relative">
                        <img src="{{ novel.cover_image.url }}" alt="{{ novel.title }}"
                             class="h-56 w-full object-cover transition-transform duration-300 group-hover:scale-105">
                        {% if novel.is_hot %}
                            <span class="absolute top-2 right-2 bg-red-600 text-white text-xs px-2 py-1 rounded shadow">HOT</span>
                        {% endif %}
                    </div>
                </a>
                <div class="p-2">
                    <a href="{% url 'novels:novel_detail' novel.id %}" class="font-semibold text-sm text-gray-800 line-clamp-2 hover:text-blue-600">
                        {{ novel.title }}
                    </a>
                    <div class="mt-1 space-y-0.5 text-xs text-gray-600">
                        {% for chapter in novel.latest_chapters.all %}
                            <div class="flex justify-between">
                                <a href="{% url 'novels:chapter_detail' novel.id chapter.id %}" class="hover:text-blue-500">
                                    Ch. {{ chapter.number }}
                                </a>
                                <span class="text-gray-400 whitespace-nowrap">{{ chapter.updated_at|timesince }} tr∆∞·ªõc</span>
                            </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>

        <!-- B·∫£ng th·∫£o lu·∫≠n -->
        <div class="w-full sm:w-auto mt-6 sm:mt-0 sm:ml-6">
            <div class="bg-white shadow-md rounded-md p-4 w-72">
                <div class="flex items-center justify-between mb-3">
                    <span class="font-semibold text-sm bg-gray-800 text-white px-2 py-1 rounded">B√¨nh Lu·∫≠n M·ªõi</span>
                    <span class="text-xs text-gray-500">{{ recent_comments.count }} b√¨nh lu·∫≠n</span>
                </div>
                
                <ul class="text-sm space-y-3">
                    {% for comment in recent_comments %}
                    <li class="group">
                        <div class="flex items-start space-x-2">
                            <!-- Avatar -->
                            <div class="flex-shrink-0">
                                <img src="{{ comment.user.profile.avatar.url|default:'/static/images/default-avatar.png' }}" 
                                     class="w-6 h-6 rounded-full object-cover border border-gray-200"
                                     alt="{{ comment.user.username }}">
                            </div>
                            
                            <!-- N·ªôi dung -->
                            <div class="flex-1 min-w-0">
                                <div class="flex items-center">
                                    <a href="#" class="font-medium text-gray-800 hover:underline truncate">
                                        {{ comment.user.username }}
                                    </a>
                                    <span class="ml-2 text-xs text-gray-500">{{ comment.created_at|timesince }} tr∆∞·ªõc</span>
                                </div>
                                <a href="#comment-{{ comment.id }}" class="block text-gray-600 hover:text-gray-800 mt-1 line-clamp-2">
                                    {{ comment.content }}
                                </a>
                            </div>
                        </div>
                    </li>
                    {% empty %}
                    <li class="text-center py-2 text-gray-500 text-sm">
                        Ch∆∞a c√≥ b√¨nh lu·∫≠n n√†o
                    </li>
                    {% endfor %}
                </ul>
                
                {% if recent_comments.count > 3 %}
                <div class="mt-3 text-center">
                    <a href="#comment-section" class="text-blue-600 hover:text-blue-800 text-sm font-medium">
                        Xem t·∫•t c·∫£ b√¨nh lu·∫≠n ‚Üí
                    </a>
                </div>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- Ti√™u ƒë·ªÅ Light Novels m·ªõi -->
    <div class="flex items-center mb-4">
        <h2 class="text-2xl font-bold text-gray-800">Light Novels M·ªõi C·∫≠p Nh·∫≠t</h2>
        <span class="ml-2 text-xs bg-blue-100 text-blue-800 px-2 py-0.5 rounded">Update</span>
    </div>

    <!-- Grid truy·ªán -->
    <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4">
        {% for novel in novels %}
            <div class="bg-white rounded-md shadow hover:shadow-lg transition overflow-hidden group">
                <a href="{% url 'novels:novel_detail' novel.id %}">
                    <div class="relative">
                        <img src="{{ novel.cover_image.url }}" alt="{{ novel.title }}"
                             class="h-56 w-full object-cover transition-transform duration-300 group-hover:scale-105">
                        {% if novel.is_hot %}
                            <span class="absolute top-2 right-2 bg-red-600 text-white text-xs px-2 py-1 rounded shadow">HOT</span>
                        {% endif %}
                    </div>
                </a>
                <div class="p-2">
                    <a href="{% url 'novels:novel_detail' novel.id %}" class="font-semibold text-sm text-gray-800 line-clamp-2 hover:text-blue-600">
                        {{ novel.title }}
                    </a>
                    <div class="mt-1 space-y-0.5 text-xs text-gray-600">
                        {% for chapter in novel.latest_chapters.all %}
                            <div class="flex justify-between">
                                <a href="{% url 'novels:chapter_detail' novel.id chapter.id %}" class="hover:text-blue-500">
                                    Ch. {{ chapter.number }}
                                </a>
                                <span class="text-gray-400 whitespace-nowrap">{{ chapter.updated_at|timesince }} tr∆∞·ªõc</span>
                            </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>

    <!-- Ph·∫ßn b√¨nh lu·∫≠n ch√≠nh -->
    <div id="comment-section" class="mt-8">
        <!-- Th√™m ph·∫ßn b√¨nh lu·∫≠n ch√≠nh ·ªü ƒë√¢y n·∫øu c·∫ßn -->
    </div>

</div>
{% endblock %}